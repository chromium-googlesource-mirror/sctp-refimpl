- Locking compatiability changes. This involves adding
  additional flags to many function calls. The flags only
  get used in BSD when we compile with lock testing. These
  flags allow apple to escape the "giant" lock it holds on
  the socket and have more fine-grained locking in the NKE.
  It also allows us to test (with witness) the locking used
  by apple via a compile switch.
********************************Above patch 18***************
- send call has a reference to uio->uioresid in
  the recent send code, but uio may be NULL on send
  file calls. Need to change to use sndlen.
- Need to do this for all calls above the copy loops.
  (change to sndlen all uio->xxx)
- EMSGSIZE is not being returned in non-blocking mode
  and needs a small tweak to look if the msg would
  ever fit when returning EWOULDBLOCK.
- FWD-TSN has a bug in stream processing which could
  cause a panic. This is a follow on to the codenomicon
  fix.
- PDAPI level 1 and 2 do not work unless the reader
  gets his returned buffer full.
- Fix fast-handoff features to copy across properly on
  accepted sockets
